# sell

> sell app

## Build Setup

``` bash
# install dependencies
npm install

# serve with hot reload at localhost:8080
npm run dev

# build for production with minification
npm run build

# build for production and view the bundle analyzer report
npm run build --report
```

https://cn.vuejs.org
	• Vue-cli启动Vuejs项目
		○ 什么是脚手架工具
			§ 帮助我们编写基础代码
		○ Vue-cli
		○ webpack是如何打包的
	• 项目准备
		○ 图片
			§ dpr的不同，推荐观看此博文!(张鑫旭)[http://www.zhangxinxu.com/wordpress/2012/08/window-devicepixelratio/]
			§ 图片尽管切成一个一个的，不用自己去构建雪碧图，构建工具会帮你处理好
			§ svg图片
				□ 矢量图，放大缩小都可以
				□ 不直接引用，而是将其转换成字体文件(icomoon免费网站)
		○ 目录设计
	• 页面骨架开发
		○ 分析组件
			§ header
			§ 导航区
			§ 内容区
		○ 编写前的工作
			§ 重置css（css reset，使用官网提供的重置，并引入HTML
			§ 移动webapp设置，宽，比例，禁止缩放
		○ 组件引用
			§ ES6标准下的模块引用，注意和node的模块进行区分
		○ 使用插件
			§ vue-router
				□ 作用
				□ 使用
					® 参照 https://router.vuejs.org/zh-cn/essentials/getting-started.html
				□ 设定默认跳转
					使用了router.push
			§ vue-resource
				□ 作用
					® 请求网络，获取数据
			§ axios
				□ 作用同上
	• header开发
		○ 分析
			§ 由于vue是数据驱动的，所以只需要把需要渲染的数据传递给组件
			§ 如何获取数据
				□ ajax请求
			§ 如何传递数据
				□ props父组件传递给子组件
			§ 如何实现设计稿并可实现其他设备上的自适应布局
				□ 使用rem
					® 测得设计稿宽750px，依照淘宝自适应的方法进行适配
					® 本来rem是不适用字体的，因为不能你屏幕大了字体跟着一块大，但我
				□ 动态修改缩放值
		○ 具体实现
			§ 详情的背景模糊设置
				□ 目前来看果真只能在ios设备上使用
				□ 但是依我来看依然有两种方法可以避开
					® 把详情页与header其他部分分离，使用事件通知来使几个组件都模糊
					® 把当前显示的页面保存为图片，依照CSS揭秘的方法放置于背景并模糊，保存图片的方法参见http://www.cnblogs.com/CTXXCH/p/6721893.html
			§ 分割线
				□ 使用了flex布局较容易实现，使用普通布局宽度不好控制（有文字
					® 使用align-self属性使hr垂直居中
					® 使用flex属性实质上是重设了flex-grow属性，使其占满剩余空间。
						◊ 推荐使用简写flex属性
			§ 优惠前icon的设计
				□ 使用class来实现
					® 要再次实现多个大小的情况，使用bg-img
				□ 出现的位置
					® 介绍页里会出现，详情页里也会出现，所以class的位置放在header子级，详情和介绍同级
		
	• star组件开发
		○ 为什么要使用此组件
			§ 方便复用
		○ 实现
			§ 输入分数、大小即可自动构建出一组评星图
			§ 数据
				□ 使用props传入
			§ 绘制星星
				□ 使用分数来确定星星类型
				□ 使用class来绘制星星
					® 本来想动态的使用dom来构建css，但是vue是数据驱动的，实现倒是可以使用dom实现，但是应该违背了vue的设计原则
					® 可使用ready事件来完成css的构建，但违背了设计原则（应该
				□ 星星的位置
					® 应该依据父组件要求的宽度平均分散到各处
						◊ 可使用text-align:justify
							} 不知道为什么不成功，难道不能应用于inline-block上吗
						◊ flex
		○ 难点
			§ 如何计算出需要绘制星星的class数组
				□ 使用计算属性，根据分数push进数组
				□ 分数四舍五入后遍历
					® 小于0.5半颗星，大于算1颗
					® 如何确定是小于还是大于
						◊ 使用新变量来缓存四舍五入后的值
					® 如何绘制不亮星的部分
						◊ 判断数组的length属性
	• icon组件开发
		○ 因为icon使用的比较多，所以也将其抽出来做成一个独立的组件
		○ 如何做？
			§ 使用props传入icon所需要的样式类型，在初期定义时要求只传入String，方便判断样式，但后来发现部分样式在数据中以数字方式存在，于是修改icon使其判断样式的具体形式
	• goods组件
		○ 分析
			§ 整体布局
				□ 左是餐单类型，右是菜单详情
				□ 自适应是必须的
			§ 滑动
				□ 本来我想对menu使用fixed类型固定，使用链接标记达到移动右边使左边active，但是看了下视频是使用js库来完成滚动
		○ 实现
			§ 分割线
				□ 我记得视频貌似是使用border实现分隔，但想了下border我不知道如何实现，或许需要在内容区外加一层容器
				□ 使用hr实现更符合语义，hr本来就是作为内容间的区分
				□ 但是hr如何和内容宽度相同成了小难题
					® menu的hr
						◊ 必须使用绝对定位以脱离正常文档流
						◊ 开始想使用margin负值把宽度拉回来，但是居中不了，作罢（使用transform应该能居中，但是没试
						◊ 对hr使用padding，愚蠢的我再次没成功
						◊ 想到了CSS的calc，成功（注意括号内运算符旁要用空格
						◊ 再使用绝对定位把hr移动
					® foodsList的hr
						◊ 竖向的，h5内的
							} 它的margin值居然能影响到下面的元素，邪门，移动端看不出来，pc浏览器下就生效了
							} 设置高宽再配合绝对定位即可
						◊ 横向
							} 因为内容区的宽度并没自适应，所以把它跟着内容区一块设置宽度即可
			§ 滚动——better-scroll
				□ 这个库实现的真是不错，文档和例子也是超级用心
				□ 使用
					® 选中需要滚动的元素的外层
					® 库只处理第一个元素的滚动
					® 子元素高度要高于父元素
				□ 如何做到右边的滚动与左边的显示联动？
					® 需要做到的效果
						◊ 根据右侧的位置计算出左侧当前应高亮
							} 如何根据当前位置与index匹配起来
								– 本来想用计算属性做判断，返回Boolean，但不知如何与index（key）联动
								– 使用计算属性，返回当前右侧处于的index值，在class中让计算属性与index作比较
									w 视频前些天看的，好像是使用大小做判断
									w 但是我认为可以使用es6的数组新方法findIndex，在回调函数中判断
						◊ 点击左侧的右侧跳转到该区域
							} 因为左边列表个数与右边ul个数相同，所以可以使用scrollToElement方法跳转
							} 也可使用高度计算进行跳转
					® 如何做
						◊ 计算y值，根据右侧的y值确定当前需要高亮的值
						◊ 数组匹配绑定，数组下标为左侧列表，值为右侧y值
						◊ 所以需要计算出元素的y值并输入到数组中，使用dom的clientHeight属性
							} 应该存进数组的是元素高度值还是元素以及前面元素的高度合集？
						◊ 判断的部分见上面分析
						◊ 点击跳转
							} 首先要接收事件，判断点击的是哪一个
							} 开启tap事件，监听tap事件，遍历list使用Object.is()比较两对象，获取index值
							} 使用scrollTo跳转到相应位置
								– scrollToElement也可以
								– 跳转后因为位置的更新差（以最上面的边界为准），跳转后不会触发左边active更新，所以对位置的更新进行了hack，让其多加10，这样更新就能同步（加1,2,3效果都不大）又不影响跳转后的显示
	• 购物车组件开发
		○ 分析
			§ 购物车组件需要传入数据，应当包括菜名、价格、数量、起送价格
			§ 因为数据需要顺序，所以需要使用数组
				□ 使用数组必须由上级组件筛选出已添加的列表，是否有必要做出这个列表？
				□ 暂时认为没有必要，直接修改元数据开发起来比较方便~
			§ 所以数据不使用数组，而是传入所有餐单，遍历，把数目不为0的添加到购物车
				□ 购物车数据需要和外部数据同步，所以应使用同一份数据，而不能分离，但使用对象的时候所用的是引用地址，所以修改的是同一份数据
				□ 当数据改变时应通知组件进行数据更新
		○ 实现
			§ 布局使用flex进行布局，实在好用
			§ 逻辑关系——使用计算属性（部分使用表达式也可以，但还是推荐使用计算属性
				□ 样式的判断
					® 高亮
					® 暗
				□ 价格的判断
				□ 数量的判断
				□ 起送价格的判断
					® 内容要自动更改
					® 样式也要跟着变化
			§ 这次下划线的实现使用了border，把左右border变宽以取代padding，使border-bottom和内容一样长
			§ 小球下落动画
				□ 分析
					® 小球必定是一个元素，但是同一时间可能有多个小球
					® 小球的轨迹是一个抛物线，现在是已知起点和终点，自己设定顶点，求这条抛物线~
					® 动画可以由js（控制position）、transition（translate、position）、animation（translate、position）来实现
						◊ 优先使用CSS3属性，因为有硬件加速
						◊ 动画或者过渡需要同时进行两个方向
						◊ 纵向可以分成两部分，一部分缓动朝上到达顶点，一部分加速向下到达终点
					® 必须有js的参与，不然无法知道起点位置
						◊ 如何获得起点位置？
							} 本来想着better-scroll自带的有位置相关的属性，但是看了一圈，文档没有说明值是什么，不靠谱
							} 使用js获取，啊啊啊加加减减的，而且都和父元素相关，头疼，过
							} 普通js倒是有一个事件相关的属性offsetX，但是实测值并不对
							} 神级函数Element.getBoundingClientRect()，basic均已实现，使用其left与top的值即可（相对视口而言的哦）
					® 利用js设置CSS
					® 小球的这个元素应当在哪里？
						◊ 由于我只看了部分视频，所以开始我也想小球应当在shopcart中，还利用事件把dom传递出去。但是购物车的位置是固定的，会变的仅仅是因自适应而改变的位置，但是在动画的终点处完全可以设置与购物车相同，所以应当把小球位置设定在cartcontrol中。虽然与购物车位置耦合了，但是写起来比较方便~
						◊ 小球的位置必须是和视口相关的，即它必须为fixed。因为如果它是相对位置的话根本就不知道各个相对应当是多少
							} 实践发现不知道为什么设置fixed并不和视口相关，找到了这篇文章https://github.com/chokcoco/iCSS/issues/24
							} 然后重新思考，absolute相对定位是可行的，因为点击位置是小球起始位置，小球从cartcontrol弹出即可，购物车位置是终点位置，使用translate即可
						
				□ 实现
					® 创建小球元素，每个小球使用一个对象，使用此对象的状态来控制小球的显示
						◊ 为什么不动态的创建DOM？因为创建ＤＯＭ的开销太大了
	• cartcontrol组件
		○ 分析
			§ cartcontrol的显示分为两个状态
				□ 等待添加
				□ 添加数量在允许的范围内
			§ 需要传入的数据
				□ 当前的商品数目
				□ 但是由于需要修改这个数目，所以传过来的必须是引用值（vue不推荐修改props，但是使用事件的方式是不是略复杂呢，事件无法定位到具体是哪一个数据
		○ 实现
			§ goods组件中使用容器包裹，以方便定位
			§ 动画
				□ 这里的动画实际上并不是动画，而是过渡
				□ 详见 https://cn.vuejs.org/v2/guide/transitions.html
					® 要对CSS属性transform掌握的十分熟练才行，像这次translate改变了坐标零点，让我好找bug
	• food组件
		○ food组件显示的实际上是04_商品页面，在触摸商品后弹出
		○ 分析
			§ 它的显示状态由它自己独立控制吗
				□ 应该不是。food页面通常较长，应该是外层被包裹着短于food页面的元素以使其滑动，组件无法控制外围元素的显示状态
				□ 但也可以是，如果不能独立控制自己的状态就不必独立抽离出来成为组件。至于外层元素只要在组件中设置就行了
			§ 如何控制它的显示状态
				□ 使组件内部响应父组件事件即可
				□ 也可使用父组件用ref来调用子组件的方法，我选择这种
		○ 遇到的问题
			§ img不会在获取到数据时显示
			§ 解决
				□ 经测试发现数据获取并不总是成功，由此想到了vue的响应机制，使用了nextTick解决了数据问题
	• ratingsDetails组件
		○ 分析
			§ 由于有两个页面使用的评价页面相同仅数据不同，所以抽离出成为组件
			§ 传入数据的不同
				□ 选择器内容的不同
				□ 评价内容的不同
		○ 遇到的问题
其他的组件开发基本上差不多，基本没有遇到新问题。还发现了width:fit-content这样的属性
总结：
	- 字体和颜色可以更省力，如一开始制定好标准，只要引用class就行。rem的转换也可以利用插件更方便。
	- 夸克浏览器实现商品页有问题，但其他浏览器正常，应该是没有获取到数据，但不知为什么会表现成那样。
			
								
				
			
			
			
				

